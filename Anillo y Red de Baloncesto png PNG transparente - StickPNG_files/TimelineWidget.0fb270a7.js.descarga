(function(){function $parcel$defineInteropFlag(e){Object.defineProperty(e,"__esModule",{value:!0,configurable:!0})}function $parcel$export(e,t,i,o){Object.defineProperty(e,t,{get:i,set:o,enumerable:!0,configurable:!0})}var $parcel$global="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},parcelRequire=$parcel$global.parcelRequired6c3;parcelRequire.register("3iFuO",(function(module,exports){$parcel$defineInteropFlag(module.exports),$parcel$export(module.exports,"default",(function(){return TimelineWidget}));var $dhZ6J=parcelRequire("dhZ6J"),$2UpbQ=parcelRequire("2UpbQ"),$1MxPP=parcelRequire("1MxPP"),$3rRHZ=parcelRequire("3rRHZ"),$39gdZ=parcelRequire("39gdZ"),$4AQp6=parcelRequire("4AQp6"),TimelineWidget=function(e,t,i){this._init(e,t,i)};TimelineWidget.prototype._init=function(e,t,i){var o,n,s,a,l,r,u;(void 0===this._eventNS&&(this._eventNS="TimelineWidget"+String(Math.random()).replace(".","")),$2UpbQ.default&&$2UpbQ.default.base64&&(window.btoa||(window.btoa=$2UpbQ.default.base64.btoa),window.atob||(window.atob=$2UpbQ.default.base64.atob),$2UpbQ.default.base64.utf8encode=!0,$2UpbQ.default.base64.utf8decode=!0),this._type=null,this._entityId=null,this._timelineId=null,this._alpha=100,this._border=!1,this._onclickActions=null,this._onclickToggleOnActions=null,this._onclickToggleOffActions=null,this._onshowActions=null,this._onhideActions=null,this._onenterKeyActions=null,this._onclosedActions=null,this._onmouseoverActions=null,this._onmouseoutActions=null,this._ontransitionDoneActions=null,this._showOnMouseHover=!1,this._arena=i,this._opts=null===(o=this._arena)||void 0===o?void 0:o._opts,this._widgetAriaLabel=null,this._savedStyles=null,this._onvalidationsucceededActions=null,this._onvalidationfailedActions=null,this._onAllWidgetsValidatedActions=null,this._onformsuccessActions=null,this._onformfailureActions=null,this._isCurrentlyShown=!1,this._localStorage=null,this._executer=null,this._boundTouchStart=!1,this._boundTouchEnd=!1,this._boundMouseDown=!1,this._boundMouseMove=!1,this._boundMouseUp=!1,this._boundMouseEnter=!1,this._boundMouseLeave=!1,this._boundKeyDown=!1,this._boundEnterKeyDown=!1,this._inpoint=null,this._outpoint=null,this._widthFromConfig=null,this._heightFromConfig=null,this._datafeeds={},this._dynamicPropertiesDict={},this._asyncDatasourceDispatches={},this.$immersionLayer=null,this.lastConfigForTranslation=null,this.$element=null,void 0!==e&&null!=e&&(this.$element=e,this.$element.data("TimelineWidget",this),this.$element.css("position","absolute"),this.$element.css("display","none"),this.$element.css("border-color","white"),this.$element.css("border-style","solid"),this.$element.css("border-width",this._border?"1px":"0px"),this.$element.css("z-index","0"),this.$element.css("cursor","auto"),this.$element.css("font-size","0"),this.$element.css("line-height","0"),this.$element.css("outline","0"),this.$wrapper=this.$element.closest(".bb_wrapper"),(!this.$wrapper||this.$wrapper.length<=0)&&(this.$wrapper=null)),this.$wrapper||(this.$wrapper=this._arena&&this._arena.$element.closest(".bb_wrapper")),(!this.$wrapper||this.$wrapper.length<=0)&&(this.$wrapper=null),this.$wrapper)&&(void 0!==(null===(n=this._arena)||void 0===n||null===(s=n.instanceService)||void 0===s?void 0:s.getInstance("SharedDataService"))&&(this._sharedDataService=this._arena.instanceService.getInstance("SharedDataService")),void 0!==(null===(a=this._arena)||void 0===a||null===(l=a.instanceService)||void 0===l?void 0:l.getInstance("Executer"))&&(this._executer=this._arena.instanceService.getInstance("Executer")),void 0!==(null===(r=this._arena)||void 0===r||null===(u=r.instanceService)||void 0===u?void 0:u.getInstance("LocalStorage"))&&(this._localStorage=this._arena.instanceService.getInstance("LocalStorage")),this.$wrapper.on("bb_resized."+this._eventNS,$2UpbQ.default.proxy(this._onResized,this)),this.$wrapper.on("bb_content_resized."+this._eventNS,$2UpbQ.default.proxy(this._onResized,this)),this.$wrapper.on("bb_fullscreen_change."+this._eventNS,$2UpbQ.default.proxy(this._onResized,this)),this.$wrapper.on("bb_datafeed_loaded."+this._eventNS,$2UpbQ.default.proxy(this._onDatafeedLoaded,this)),this.$wrapper.on("bb_datafeed_load_failed."+this._eventNS,$2UpbQ.default.proxy(this._onDatafeedLoadFailed,this)),this.$wrapper.on("bb_localstorage_updated."+this._eventNS,$2UpbQ.default.proxy(this._onLocalStorageUpdated,this)));if(!this._localStorage&&this.$element)try{this._localStorage=new $3rRHZ.default(this.$wrapper,this._opts)}catch(e){$1MxPP.default("[TimelineWidget] Failed to instantiate LocalStorage")}this.ignoreTimelineShow=!1,this.ignoreTimelineHide=!1,void 0!==t.widgetdefinitiontype&&(this._type=t.widgetdefinitiontype),void 0!==t.id&&(this._entityId=t.id),void 0!==t.timelineId&&(this._timelineId=t.timelineId),void 0!==t.useSession&&(this._useSession="true"===t.useSession||!0===t.useSession),void 0!==t.inpoint&&(this._inpoint=t.inpoint),void 0!==t.label&&(this._widgetAriaLabel=t.label),void 0!==t.outpoint&&(this._outpoint=t.outpoint),this._initialConfigJSON=JSON.stringify(t),this.update(TimelineWidget._getConfig(t))},TimelineWidget._getConfig=function(e,t,i){var o=!1;if(void 0===t&&(t="default"),void 0===i&&(i="default"),void 0!==e.statesets){for(var n=0;n<e.statesets.length&&e.statesets[n].name!==t;)n++;if(n<e.statesets.length){var s=e.statesets[n];if(void 0!==s.states){for(var a=0;a<s.states.length&&s.states[a].name!==i;)a++;if(a<s.states.length)o=s.states[a].config}}}else o=e;if(e.apps){for(var l=0;l<e.apps.length&&(!e.apps[l]||e.apps[l].id!==o.appid);)l++;l<e.apps.length&&(o.app=e.apps[l])}return e.grouping&&(o.grouping=e.grouping),o},TimelineWidget.prototype.restoreInitialConfig=function(){if(this._initialConfigJSON){var e=TimelineWidget._getConfig(JSON.parse(this._initialConfigJSON));delete e.grouping,delete e.ignoreTimelineHide,delete e.ignoreTimelineShow,this.update(e)}},TimelineWidget.prototype.exit=function(){return this.$wrapper&&(this.$wrapper.off("bb_resized."+this._eventNS),this.$wrapper.off("bb_content_resized."+this._eventNS),this.$wrapper.off("bb_fullscreen_change."+this._eventNS),this.$wrapper.off("bb_datafeed_loaded."+this._eventNS),this.$wrapper.off("bb_localstorage_updated."+this._eventNS)),this.$element&&(this.$element.off("touchstart."+this._eventNS),this.$element.off("touchend."+this._eventNS),$2UpbQ.default(document).off("touchend."+this._eventNS),this.$element.off("mousedown."+this._eventNS),this.$element.off("mousemove."+this._eventNS),this.$element.off("mouseup."+this._eventNS),$2UpbQ.default(document).off("mouseup."+this._eventNS),this.$element.off("mouseenter."+this._eventNS),this.$element.off("mouseleave."+this._eventNS),this.$element.off("keydown."+this._eventNS),this.$element.off("bb_validationsucceeded."+this._eventNS),this.$element.off("bb_validationfailed."+this._eventNS),this.$element.off("bb_allwidgetsvalidated."+this._eventNS),this.$element.off("bb_formsuccess."+this._eventNS),this.$element.off("bb_formfailure."+this._eventNS),this.$element.data("TimelineWidget",null)),null},TimelineWidget.prototype.update=function(e){for(var t in void 0!==e.ignoreTimelineShow&&(this.ignoreTimelineShow="true"==e.ignoreTimelineShow),void 0!==e.ignoreTimelineHide&&(this.ignoreTimelineHide="true"==e.ignoreTimelineHide),e)if("widgetdefinitiontype"!=t&&"id"!=t&&"timelineId"!=t&&"ignoreTimelineShow"!=t&&"ignoreTimelineHide"!=t){var i;if("string"==typeof e[t]){e[t]=this._replaceMacroStrings(e[t]);var o=e[t].match(/dataSource:\{[^}]*\}/gm);if(null!=o)for(var n=0;n<o.length;n++)e[t]=e[t].replace(o[n],this._processDataSource(o[n]))}else e[t]&&("object"==typeof e[t]&&e[t].datasource||e[t+"_dataSource"])&&(-1!==t.indexOf("_dataSource")&&(t=t.replace("_dataSource","")),i=(e[t+"_dataSource"]||e[t]).datasource,e[t+"_dataSource"]={datasource:i},i.sourceValue&&(i.sourceValue=this._replaceMacroStrings(i.sourceValue)),i.defaultValue&&(i.defaultValue=this._replaceMacroStrings(i.defaultValue)),e[t]=this._processDataSource_obj(i,t))}if(void 0!==e.cssclass&&""!=e.cssclass&&void 0!==this.$element&&null!=this.$element&&this.$element.addClass(e.cssclass),void 0!==this.$element&&null!=this.$element){if(null!=this._entityId&&this.$element.attr("id","bb-tw-"+this._entityId),void 0!==e.width){var s=this._widthFromConfig=e.width.toString();s.indexOf("%")>=0?this.$element.css("width",s):this.$element.width(Math.round(s))}if(void 0!==e.height){var a=this._heightFromConfig=e.height.toString();a.indexOf("%")>=0||"auto"==a||""==a?this.$element.css("height",a):this.$element.height(Math.round(a))}if(void 0!==e.xpos){var l=e.xpos.toString();l.indexOf("%")>=0?this.$element.css("left",l):this.$element.css("left",Math.round(l).toString()+"px")}if(void 0!==e.ypos){var r=e.ypos.toString();r.indexOf("%")>=0?this.$element.css("top",r):this.$element.css("top",Math.round(r).toString()+"px")}if(void 0!==e.ll_x&&void 0!==e.ll_y&&void 0!==e.lr_x&&void 0!==e.lr_y&&void 0!==e.ul_x&&void 0!==e.ul_y&&void 0!==e.ur_x&&void 0!==e.ur_y){this.lastConfigForTranslation=e;var u,d,c,h=this.getAbsoluteValueFromWidth(e.ll_x),p=this.getAbsoluteValueFromWidth(e.lr_x),f=this.getAbsoluteValueFromWidth(e.ul_x),g=this.getAbsoluteValueFromWidth(e.ur_x),_=this.getAbsoluteValueFromHeight(e.ll_y),v=this.getAbsoluteValueFromHeight(e.lr_y),m=this.getAbsoluteValueFromHeight(e.ul_y),y=this.getAbsoluteValueFromHeight(e.ur_y);d=null!=this._widthFromConfig?this._widthFromConfig.indexOf("%")>=0?this.getAbsoluteValueFromWidth(this._widthFromConfig):Math.round(s):this.$element.parent().width();var b=[{x:0,y:0},{x:0,y:c=null!=this._heightFromConfig&&"app"!=this._type?this._heightFromConfig.indexOf("%")>=0?this.getAbsoluteValueFromHeight(this._heightFromConfig):Math.round(a):this.$element.parent().height()},{x:d,y:0},{x:d,y:c}],$=[{x:f,y:m},{x:h,y:_},{x:g,y:y},{x:p,y:v}],w="";try{var S=[[b[0].x,b[0].y,1,0,0,0,-b[0].x*$[0].x,-b[0].y*$[0].x],[0,0,0,b[0].x,b[0].y,1,-b[0].x*$[0].y,-b[0].y*$[0].y],[b[1].x,b[1].y,1,0,0,0,-b[1].x*$[1].x,-b[1].y*$[1].x],[0,0,0,b[1].x,b[1].y,1,-b[1].x*$[1].y,-b[1].y*$[1].y],[b[2].x,b[2].y,1,0,0,0,-b[2].x*$[2].x,-b[2].y*$[2].x],[0,0,0,b[2].x,b[2].y,1,-b[2].x*$[2].y,-b[2].y*$[2].y],[b[3].x,b[3].y,1,0,0,0,-b[3].x*$[3].x,-b[3].y*$[3].x],[0,0,0,b[3].x,b[3].y,1,-b[3].x*$[3].y,-b[3].y*$[3].y]],A=$39gdZ.default.inverse(S),x=[$[0].x,$[0].y,$[1].x,$[1].y,$[2].x,$[2].y,$[3].x,$[3].y],T=$39gdZ.default.getColumn($39gdZ.default.multiplyVector(A,x),0);u=[T[0],T[3],0,T[6],T[1],T[4],0,T[7],0,0,1,0,T[2],T[5],0,1],w+="matrix3d(".concat(u.join(", "),")")}catch(e){$1MxPP.default("TimelineWidget: contrib sylvester catch error = "+e.message)}if(""!=w){this.$element.css("left","0%"),this.$element.css("top","0%"),this.$element.css("transform-origin","0px 0px 0px"),this.$element.css("transform",w),void 0!==this.$immersionLayer&&null!=this.$immersionLayer||(this.$element.wrap('<div class="bb-immersion" style="position:absolute; width:100%; height:100%; top:0; left:0;pointer-events:none;"></div>'),this.$immersionLayer=this.$element.parent());var k=this.getLinesIntersectionPoint(f,m,p,v,g,y,h,_);if(void 0!==this.previousMiddlePoint&&null!=this.previousMiddlePoint&&null!=k.x&&null!=k.y){var W=Math.sqrt(Math.pow(this.previousMiddlePoint.x-k.x,2)+Math.pow(k.y-k.y,2)),D=this.$immersionLayer.height()/800,O=this.$immersionLayer.height()/1100,V=W>D?D:W;V>0?(this.$immersionLayer.css("-webkit-filter","blur("+V+"px)"),this.$immersionLayer.css("filter","blur("+V+"px)")):(this.$immersionLayer.css("-webkit-filter","blur("+O+"px)"),this.$immersionLayer.css("filter","blur("+O+"px)"))}this.previousMiddlePoint=k}}if(void 0!==e.color&&this.$element.children().css("background-color","#"+e.color),void 0!==e.alpha&&(this._alpha=e.alpha,this.$element.children().css("opacity",parseFloat(this._alpha)/100)),void 0!==e.border&&(this._border="true"==e.border,this.$element.css("border-width",this._border?"1px":"0px")),void 0!==e.onclick&&(e.onclick?this._onclickActions="string"==typeof e.onclick?e.onclick.split("\n"):e.onclick.actions||e.onclick:this._onclickActions=null,this._onclickActions&&this._onclickActions.length>0&&(this.$element.css("cursor","pointer"),this._bindClickAndTouch())),void 0!==e.onenter&&(e.onenter?this._onenterKeyActions="string"==typeof e.onenter?e.onenter.split("\n"):e.onenter.actions||e.onenter:this._onenterKeyActions=null,this._onenterKeyActions&&this._onenterKeyActions.length>0&&this._bindEnterKeyDown()),void 0!==e.imageid_toggle&&e.imageid_toggle&&this._bindClickAndTouch(),void 0!==e.onclickToggleOn&&(e.onclickToggleOn?this._onclickToggleOnActions="string"==typeof e.onclickToggleOn?e.onclickToggleOn.split("\n"):e.onclickToggleOn.actions||e.onclickToggleOn:this._onclickToggleOnActions=null,this._onclickToggleOnActions&&this._onclickToggleOnActions.length>0&&(this.$element.css("cursor","pointer"),this._bindClickAndTouch())),void 0!==e.onclickToggleOff&&(e.onclickToggleOff?this._onclickToggleOffActions="string"==typeof e.onclickToggleOff?e.onclickToggleOff.split("\n"):e.onclickToggleOff.actions||e.onclickToggleOff:this._onclickToggleOffActions=null,this._onclickToggleOffActions&&this._onclickToggleOffActions.length>0&&(this.$element.css("cursor","pointer"),this._bindClickAndTouch())),void 0!==e.onmouseover&&(e.onmouseover?this._onmouseoverActions="string"==typeof e.onmouseover?e.onmouseover.split("\n"):e.onmouseover.actions||e.onmouseover:this._onmouseoverActions=null,this._onmouseoverActions&&this._onmouseoverActions.length>0&&(this._bindEnterAndLeave(),this._bindClickAndTouch())),void 0!==e.onmouseout&&(e.onmouseout?this._onmouseoutActions="string"==typeof e.onmouseout?e.onmouseout.split("\n"):e.onmouseout.actions||e.onmouseout:this._onmouseoutActions=null,this._onmouseoutActions&&this._onmouseoutActions.length>0&&(this._bindEnterAndLeave(),this._bindClickAndTouch())),void 0!==e.onvalidationsucceeded&&(e.onvalidationsucceeded?this._onvalidationsucceededActions="string"==typeof e.onvalidationsucceeded?e.onvalidationsucceeded.split("\n"):e.onvalidationsucceeded.actions||e.onvalidationsucceeded:this._onvalidationsucceededActions=null,this._onvalidationsucceededActions&&this._onvalidationsucceededActions.length>0&&this.$element.on("bb_validationsucceeded."+this._eventNS,$2UpbQ.default.proxy(this._onValidationSucceeded,this))),void 0!==e.onvalidationfailed&&(e.onvalidationfailed?this._onvalidationfailedActions="string"==typeof e.onvalidationfailed?e.onvalidationfailed.split("\n"):e.onvalidationfailed.actions||e.onvalidationfailed:this._onvalidationfailedActions=null,this._onvalidationfailedActions&&this._onvalidationfailedActions.length>0&&this.$element.on("bb_validationfailed."+this._eventNS,$2UpbQ.default.proxy(this._onValidationFailed,this))),void 0!==e.onAllWidgetsValidated&&(e.onAllWidgetsValidated?this._onAllWidgetsValidatedActions="string"==typeof e.onAllWidgetsValidated?e.onAllWidgetsValidated.split("\n"):e.onAllWidgetsValidated.actions||e.onAllWidgetsValidated:this._onAllWidgetsValidatedActions=null,this._onAllWidgetsValidatedActions&&this._onAllWidgetsValidatedActions.length>0&&this.$element.on("bb_allwidgetsvalidated."+this._eventNS,$2UpbQ.default.proxy(this._onAllWidgetsValidated,this))),void 0!==e.onSuccess&&(e.onSuccess?this._onformsuccessActions="string"==typeof e.onSuccess?e.onSuccess.split("\n"):e.onSuccess.actions||e.onSuccess:this._onformsuccessActions=null,this._onformsuccessActions&&this._onformsuccessActions.length>0&&this.$element.on("bb_formsuccess."+this._eventNS,$2UpbQ.default.proxy(this._onFormSuccess,this))),void 0!==e.onFailure&&(e.onFailure?this._onformfailureActions="string"==typeof e.onFailure?e.onFailure.split("\n"):e.onFailure.actions||e.onFailure:this._onformfailureActions=null,this._onformfailureActions&&this._onformfailureActions.length>0&&this.$element.on("bb_formfailure."+this._eventNS,$2UpbQ.default.proxy(this._onFormFailure,this))),void 0!==e.ontransitionDone&&(e.ontransitionDone?this._ontransitionDoneActions="string"==typeof e.ontransitionDone?e.ontransitionDone.split("\n"):e.ontransitionDone.actions||e.ontransitionDone:this._ontransitionDoneActions=null),void 0!==e.showOnMouseHover&&(this._showOnMouseHover="true"==e.showOnMouseHover,this._showOnMouseHover&&(this._bindEnterAndLeave(),this._bindClickAndTouch(),this.$element.css("border-width","0px"),this.$element.children().css("opacity","0.0"))),void 0!==e.showCloseButton&&"true"==e.showCloseButton){var M=$2UpbQ.default('<button style="position:absolute;right:0px;top:0px;background:#eee;height:16px;width:16px;margin:0;padding:0;line-height:8px;cursor:pointer;z-index:2;" title="close">X</button>');M.on("click."+this._eventNS,this,(function(e){return e.data._onCloseButtonClicked(e)})),this.$element.append(M)}if(void 0!==e.grouping){var I="string"==typeof e.grouping?e.grouping.split("\n"):e.grouping.groups||e.grouping;if("array"===(void 0===I?"undefined":$dhZ6J.typeOf(I))||"object"==typeof I)for(var n in I)if(parseInt(n)>=0){this._arena.getGroupById(I[n]).addMember(this)}}}void 0!==e.onshow&&(e.onshow?this._onshowActions="string"==typeof e.onshow?e.onshow.split("\n"):e.onshow.actions||e.onshow:this._onshowActions=null),void 0!==e.onhide&&(e.onhide?this._onhideActions="string"==typeof e.onhide?e.onhide.split("\n"):e.onhide.actions||e.onhide:this._onhideActions=null),void 0!==e.onclosed&&(e.onclosed?this._onclosedActions="string"==typeof e.onclosed?e.onclosed.split("\n"):e.onclosed.actions||e.onclosed:this._onclosedActions=null),null!=this.$element&&(null!=this._onclickActions&&this._onclickActions.length>0||null!=this._onclickToggleOffActions&&this._onclickToggleOffActions.length>0||null!=this._onclickToggleOnActions&&this._onclickToggleOnActions.length>0)&&(this.$element.attr("role","button"),this.$element.attr("aria-label",this._widgetAriaLabel),this.$element.attr("tabindex",0))},TimelineWidget.prototype.show=function(){if(!this._isCurrentlyShown&&(this._isCurrentlyShown=!0,void 0!==this.$element&&null!=this.$element&&("image"==this._type&&this.$element.css("visibility","visible").children("img").show(),"video"==this._type&&this.$element.css({marginLeft:"0"}),this.$element.show(),"function"==typeof this.resume&&this.resume(),"function"==typeof this.showWidgets&&this.showWidgets(),this.$element.trigger("bb_widget_shown")),"array"===$dhZ6J.typeOf(this._onshowActions)||"object"==typeof this._onshowActions))for(var e in this._onshowActions)parseInt(e)>=0&&this._handleAction(this._onshowActions[e])},TimelineWidget.prototype.hide=function(){if(this._isCurrentlyShown&&(this._isCurrentlyShown=!1,void 0!==this.$element&&null!=this.$element&&($1MxPP.default("TimelineWidget: hide: this.$element is OK"),"image"==this._type?this.$element.css("visibility","hidden").children("img").hide():"video"==this._type?this.$element.css({marginLeft:"-10000px"}):this.$element.hide(),"function"==typeof this.pause&&this.pause(),"function"==typeof this.hideWidgets&&this.hideWidgets()),"array"===$dhZ6J.typeOf(this._onhideActions)||"object"==typeof this._onhideActions))for(var e in this._onhideActions)parseInt(e)>=0&&this._handleAction(this._onhideActions[e])},TimelineWidget.prototype.getEntityId=function(){return this._entityId},TimelineWidget.prototype.getTimelineId=function(){return this._timelineId},TimelineWidget.prototype.getOnshowActions=function(){return this._onshowActions},TimelineWidget.prototype.getOnhideActions=function(){return this._onhideActions},TimelineWidget.prototype.getOnclickActions=function(){return this._onclickActions},TimelineWidget.prototype.getOntransitionDoneActions=function(){return this._ontransitionDoneActions},TimelineWidget.hexToRgba=function(e,t){var i=[],o=parseInt(e,16);return isNaN(parseFloat(t))&&(t="100%"),i[0]=Math.floor(o/65536),o-=65536*i[0],i[1]=Math.floor(o/256),o-=256*i[1],i[2]=Math.floor(o),i[3]=parseFloat(t)/100,"rgba("+i.join(",")+")"},TimelineWidget.prototype._bindClickAndTouch=function(){this.$element&&(this._boundTouchStart||(this._boundTouchStart=!0,this.$element.on("touchstart."+this._eventNS,$2UpbQ.default.proxy(this._onTouchStart,this))),this._boundTouchEnd||(this._boundTouchEnd=!0,this.$element.on("touchend."+this._eventNS,$2UpbQ.default.proxy(this._onTouchEnd,this)),$2UpbQ.default(document).on("touchend."+this._eventNS,$2UpbQ.default.proxy(this._onTouchEnd,this))),this._boundMouseDown||(this._boundMouseDown=!0,this.$element.on("mousedown."+this._eventNS,$2UpbQ.default.proxy(this._onMouseDown,this))),this._boundMouseMove||(this._boundMouseMove=!0,this.$element.on("mousemove."+this._eventNS,$2UpbQ.default.proxy(this._onMouseMove,this))),this._boundMouseUp||(this._boundMouseUp=!0,this.$element.on("mouseup."+this._eventNS,$2UpbQ.default.proxy(this._onMouseUp,this)),$2UpbQ.default(document).on("mouseup."+this._eventNS,$2UpbQ.default.proxy(this._onMouseUp,this))),this._boundKeyDown||(this._boundKeyDown=!0,this.$element.on("keydown."+this._eventNS,$2UpbQ.default.proxy(this._onKeyDown,this))))},TimelineWidget.prototype._bindEnterAndLeave=function(){this.$element&&(this._boundMouseEnter||(this._boundMouseEnter=!0,this.$element.on("mouseenter."+this._eventNS,$2UpbQ.default.proxy(this._onMouseEnter,this))),this._boundMouseLeave||(this._boundMouseLeave=!0,this.$element.on("mouseleave."+this._eventNS,$2UpbQ.default.proxy(this._onMouseLeave,this))))},TimelineWidget.prototype._bindEnterKeyDown=function(){this.$element&&(this.$input=this.$element.find("input, textarea"),this.$input.length<=0&&(this.$input=null),null!=this.$input&&(this._boundEnterKeyDown||(this._boundEnterKeyDown=!0,this.$input.on("keydown."+this._eventNS,$2UpbQ.default.proxy(this._onEnterKeyDown,this)))))},TimelineWidget.prototype._onKeyDown=function(e){e&&void 0!==e.key&&"Enter"===e.key&&(this._onMouseDown(e),this._onMouseUp(e))},TimelineWidget.prototype._onEnterKeyDown=function(e){if(e&&void 0!==e.key&&"Enter"===e.key&&this._isCurrentlyShown&&("array"===$dhZ6J.typeOf(this._onenterKeyActions)||"object"==typeof this._onenterKeyActions))for(var t in this._onenterKeyActions)parseInt(t)>=0&&this._handleAction(this._onenterKeyActions[t])},TimelineWidget.prototype._onMouseDown=function(e){this._isTouch&&this._boundMouseEnter&&this._onMouseEnter(e),$1MxPP.default("[TimelineWidget:"+this._entityId+"] _onMouseDown"),this._mouseDown||(this._mouseDown=!0,this._mouseDownTarget=e.target)},TimelineWidget.prototype._onMouseMove=function(e){this._mouseDown&&($1MxPP.default("[TimelineWidget:"+this._entityId+"] _onMouseMove while mouse down"),e.preventDefault())},TimelineWidget.prototype._onMouseUp=function(e){if($1MxPP.default("[TimelineWidget:"+this._entityId+"] _onMouseUp"),this._mouseDown&&(this._mouseDown=!1,e.target===this._mouseDownTarget&&(this._mouseDownTarget=null,$1MxPP.default("[TimelineWidget:"+this._entityId+"] _onMouseUp correct target"),this._isCurrentlyShown))){var t;if(null===(t=this.$element)||void 0===t||t.trigger("bb_widget_clicked",[{entityId:this._entityId,timelineId:this._timelineId}]),"array"===$dhZ6J.typeOf(this._onclickActions)||"object"==typeof this._onclickActions)for(var i in this._onclickActions)parseInt(i)>=0&&this._handleAction(this._onclickActions[i]);var o=!1;if("function"==typeof this.toggleContent&&"function"==typeof this.getToggleState)if(o=this.getToggleState(),this.toggleContent(),o){if("array"===$dhZ6J.typeOf(this._onclickToggleOnActions)||"object"==typeof this._onclickToggleOnActions)for(var i in this._onclickToggleOnActions)parseInt(i)>=0&&this._handleAction(this._onclickToggleOnActions[i])}else if("array"===$dhZ6J.typeOf(this._onclickToggleOffActions)||"object"==typeof this._onclickToggleOffActions)for(var i in this._onclickToggleOffActions)parseInt(i)>=0&&this._handleAction(this._onclickToggleOffActions[i])}if(this._isTouch&&this._boundMouseLeave){var n=this;window.setTimeout((function(){n._onMouseLeave(e)}),40)}},TimelineWidget.prototype._onCloseButtonClicked=function(e){if(this._isCurrentlyShown&&(this.hide(),"array"===$dhZ6J.typeOf(this._onclosedActions)||"object"==typeof this._onclosedActions))for(var t in this._onclosedActions)parseInt(t)>=0&&this._handleAction(this._onclosedActions[t])},TimelineWidget.prototype._onMouseEnter=function(e){if($1MxPP.default("[TimelineWidget:"+this._entityId+"] _onMouseEnter"),!this._mouseEnter&&(this._mouseEnter=!0,$1MxPP.default("[TimelineWidget:"+this._entityId+"] _onMouseEnter while left"),this._isCurrentlyShown)){var t,i;if(this._showOnMouseHover)null===(t=this.$element)||void 0===t||t.css("border-width",this._border?"1px":"0px"),null===(i=this.$element)||void 0===i||i.children().css("opacity",parseFloat(this._alpha)/100);if("array"===$dhZ6J.typeOf(this._onmouseoverActions)||"object"==typeof this._onmouseoverActions)for(var o in this._onmouseoverActions)parseInt(o)>=0&&this._handleAction(this._onmouseoverActions[o],this._isTouch)}},TimelineWidget.prototype._onTouchStart=function(e,t){this._isTouch=!0,t&&t.ignore||this._touchStart||(this._touchStart=!0,e.stopPropagation(),$2UpbQ.default(e.target).trigger(e.type,[{ignore:!0}]))},TimelineWidget.prototype._onTouchEnd=function(e,t){this._isTouch=!0,t&&t.ignore||this._touchStart&&(this._touchStart=!1,e.stopPropagation(),$2UpbQ.default(e.target).trigger(e.type,[{ignore:!0}]))},TimelineWidget.prototype._onMouseLeave=function(e){if($1MxPP.default("[TimelineWidget:"+this._entityId+"] _onMouseLeave"),this._mouseEnter&&(this._mouseEnter=!1,$1MxPP.default("[TimelineWidget:"+this._entityId+"] _onMouseLeave while entered"),this._isCurrentlyShown)){var t,i;if(this._showOnMouseHover)null===(t=this.$element)||void 0===t||t.css("border-width","0px"),null===(i=this.$element)||void 0===i||i.children().css("opacity","0.0");if("array"===$dhZ6J.typeOf(this._onmouseoutActions)||"object"==typeof this._onmouseoutActions)for(var o in this._onmouseoutActions)parseInt(o)>=0&&this._handleAction(this._onmouseoutActions[o],this._isTouch)}},TimelineWidget.prototype._onValidationSucceeded=function(e){if($1MxPP.default("TimelineWidget.prototype._onValidationSucceeded"),"array"===$dhZ6J.typeOf(this._onvalidationsucceededActions)||"object"==typeof this._onvalidationsucceededActions)for(var t in this._onvalidationsucceededActions)parseInt(t)>=0&&this._handleAction(this._onvalidationsucceededActions[t])},TimelineWidget.prototype._onValidationFailed=function(e){if("array"===$dhZ6J.typeOf(this._onvalidationfailedActions)||"object"==typeof this._onvalidationfailedActions)for(var t in this._onvalidationfailedActions)parseInt(t)>=0&&this._handleAction(this._onvalidationfailedActions[t])},TimelineWidget.prototype._onAllWidgetsValidated=function(e){if("array"===$dhZ6J.typeOf(this._onAllWidgetsValidatedActions)||"object"==typeof this._onAllWidgetsValidatedActions)for(var t in this._onAllWidgetsValidatedActions)parseInt(t)>=0&&this._handleAction(this._onAllWidgetsValidatedActions[t])},TimelineWidget.prototype._onFormSuccess=function(e){if("array"===$dhZ6J.typeOf(this._onformsuccessActions)||"object"==typeof this._onformsuccessActions)for(var t in this._onformsuccessActions)parseInt(t)>=0&&this._handleAction(this._onformsuccessActions[t])},TimelineWidget.prototype._onFormFailure=function(e){if("array"===$dhZ6J.typeOf(this._onformfailureActions)||"object"==typeof this._onformfailureActions)for(var t in this._onformfailureActions)parseInt(t)>=0&&this._handleAction(this._onformfailureActions[t])},TimelineWidget.prototype._processDataSource=function(e){var t=!1;if(e){var i=null;if("string"==typeof e)try{i=JSON.parse($2UpbQ.default.trim(e.replace(/^dataSource:/i,"")))}catch(e){i=null}else i={sourceType:e.sourceType,sourceValue:this._replaceMacroStrings(e.sourceValue),defaultValue:this._replaceMacroStrings(e.defaultValue)};t=this._processDataSource_obj(i)}return t},TimelineWidget.prototype._filterDatafeed=function(e){var t=this,i=[];if(e&&e.columns&&e.rows){i=e.rows;var o=e.columns.filter((function(e){return e&&"condition"===e.headerType&&e.key})).map((function(e){return e.key}));o&&o.length&&(i=e.rows.filter((function(e){var i=!0;return o.forEach((function(o){if(i){var n=t._localStorage.get("bbtl_"+o),s=e[o],a=s;if("object"==typeof s)switch(a=s.value,s.operator){case"is":case"isNot":i=n===a||String(n)===String(a),"isNot"===s.operator&&(i=!i);break;case">":i=parseFloat(n)>parseFloat(a);break;case"<":i=parseFloat(n)<parseFloat(a);break;case"defined":case"undefined":i=null!=n,"undefined"===s.operator&&(i=!i);break;case"doesNotContain":case"contains":i=n&&n.toLowerCase&&a&&a.toLowerCase&&-1!==n.toLowerCase().indexOf(a.toLowerCase()),"doesNotContain"===s.operator&&(i=!i)}else void 0!==a&&(i=n===a||String(n)===String(a))}})),i})))}return i},TimelineWidget.prototype._onDatafeedLoaded=function(e,t){var i=this;t&&t.datafeed&&t.datafeed.id&&(this._datafeeds[t.datafeed.id]=t.datafeed,this._updateDatafeedProps(),this._asyncDatasourceDispatches[t.datafeed.id]&&this._asyncDatasourceDispatches[t.datafeed.id].length&&(this._asyncDatasourceDispatches[t.datafeed.id].forEach((function(e){i._handleAction_dispatch(e)})),delete this._asyncDatasourceDispatches[t.datafeed.id]))},TimelineWidget.prototype._onDatafeedLoadFailed=function(e,t){var i=this;t&&t.id&&(delete this._datafeeds[t.id],i._asyncDatasourceDispatches[t.id]&&i._asyncDatasourceDispatches[t.id].length&&(i._asyncDatasourceDispatches[t.id].forEach((function(e){i._handleAction_dispatch(e)})),delete i._asyncDatasourceDispatches[t.id]))},TimelineWidget.prototype._onLocalStorageUpdated=function(e,t){this._updateDatafeedProps()},TimelineWidget.prototype._updateDatafeedProps=function(e){this._dynamicPropertiesDict&&this._dynamicPropertiesDict!=={}&&this.update(JSON.parse(JSON.stringify(this._dynamicPropertiesDict)))},TimelineWidget.prototype._fetchDatafeed=function(e){var t=this.$wrapper;if(!this._datafeeds[e]&&(this._datafeeds[e]={},this._opts&&this._opts.publicationData&&this._opts.publicationData.server&&e)){var i=this._opts.publicationData.server+"/sapi/datafeed/"+e;$4AQp6.fetchData(i).then((function(i){i?t&&t.trigger("bb_datafeed_loaded",[{datafeed:i}]):(console.warn("error fetching datafeed","no data"),t&&t.trigger("bb_datafeed_load_failed",[{id:e}]))})).catch((function(i){console.warn("error fetching datafeed",i),t&&t.trigger("bb_datafeed_load_failed",[{id:e}])}))}},TimelineWidget.prototype._processDataSource_obj=function(e,t){var i,o="";if(null!=e&&void 0!==e.sourceType&&void 0!==e.sourceValue)if("JavaScript"==e.sourceType&&""!=e.sourceValue&&null!=this._executer&&"function"==typeof this._executer.execute){var n=this._executer.execute(e.sourceValue);void 0!==n?o=n:void 0!==e.defaultValue&&(o=String(e.defaultValue))}else if("QueryString"==e.sourceType&&""!=e.sourceValue){if(null===(i=this._opts)||void 0===i?void 0:i.joinedRequestParams){var s=this._opts.joinedRequestParams[String(e.sourceValue)];if(null!=s&&void 0!==s&&""!=s){var a;try{a=$2UpbQ.default.base64.decode(s)}catch(e){}o=null!=a&&void 0!==a?a:s}else void 0!==e.defaultValue&&null!=e.defaultValue&&(o=String(e.defaultValue))}}else if("LocalStorage"==e.sourceType&&""!=e.sourceValue){if(this._localStorage){var l=this._localStorage.get("bbtl_"+e.sourceValue);void 0!==l&&null!=l?o=l:void 0!==e.defaultValue&&null!=e.defaultValue&&(o=String(e.defaultValue))}}else if("PlainText"==e.sourceType)void 0!==e.sourceValue&&null!=e.sourceValue&&""!=e.sourceValue?o=e.sourceValue:void 0!==e.defaultValue&&null!=e.defaultValue&&(o=String(e.defaultValue));else if("DatafeedValue"==e.sourceType&&""!=e.sourceValue){if(void 0!==e.sourceValue&&null!=e.sourceValue)if(2==(p=e.sourceValue.split(":")).length&&null!=p[0]&&void 0!==p[0]&&null!=p[1]&&void 0!==p[1]){var r=p[0],u=p[1];if(t&&(this._dynamicPropertiesDict[t]={datasource:e}),this._datafeeds[r]){var d=this._datafeeds[r],c=this._filterDatafeed(d);if(c&&c.length){var h="true"===d.randomRowSelection||!0===d.randomRowSelection?Math.floor(Math.random()*c.length):0;void 0!==c[h][u]&&(o=String(c[h][u]))}else o=void 0!==e.defaultValue&&null!=e.defaultValue?String(e.defaultValue):""}else this._fetchDatafeed(r),o=void 0!==e.defaultValue&&null!=e.defaultValue?String(e.defaultValue):""}}else if("WidgetProperty"==e.sourceType&&""!=e.sourceValue){var p;if(void 0!==e.sourceValue&&null!=e.sourceValue)if(2==(p=e.sourceValue.split(":")).length&&null!=p[0]&&void 0!==p[0]&&null!=p[1]&&void 0!==p[1]){var f=p[0],g=p[1],_=this._arena.getWidgetById(f);null!=_&&(o=_.getPropertyValue(g))}else o=void 0!==e.defaultValue&&null!=e.defaultValue?String(e.defaultValue):"";else void 0!==e.defaultValue&&null!=e.defaultValue&&""!=e.sourceValue&&(o=String(e.defaultValue))}return o},TimelineWidget.prototype._handleAction=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(void 0!==e){var i=!0,o=[],n=[];"object"!=typeof e||void 0===e.condition&&void 0===e.actions&&void 0===e.else_actions?"object"==typeof e?(void 0!==e.conditions&&(i=this._evaluateConditions(e.conditions)),o=[e.action]):o=[e]:(void 0!==e.condition&&(i=this._evaluateCondition(e.condition)),o=e.actions||[],n=e.else_actions||[]);var s=0;if(i)for(s=0;s<o.length;s++)this._handleAction_dispatch(o[s],t);else for(s=0;s<n.length;s++)this._handleAction_dispatch(n[s],t)}},TimelineWidget.prototype._handleAction_dispatch=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=null,o=null,n=null,s=!1,a=!0;if("string"==typeof e){var l=/^(\w*):(\w*)(.*)$/,r=l.exec($2UpbQ.default.trim(e));if(null!=r){i=r[1].toString(),o=r[2].toString();var u=r[3].toString(),d=o+u;n=[];if(u.length>0){d=o+(u=this._replaceMacroStrings(u));var c=u.match(/dataSource:\{[^}]*\}/gm);if(null!=c)for(var h=0;h<c.length;h++){var p=this._processDataSource(c[h]);u=u.replace(c[h],JSON.stringify(p))}d=o+u;n=null;var f=/,/gm;if((u=(u=(u=u.replace(/^\(|\)$/gm,"")).replace(/\\"/gm,"%escaped_double_quote%")).replace(/\\'/gm,"%escaped_single_quote%")).match(f)){n=[];for(var g=/"/gm,_=[];null!==g.exec(u);)_.push(g.lastIndex-1);_.push(u.length);var v=-1;for(f=/,/gm;null!==f.exec(u);){var m=f.lastIndex-1;for(h=0;h<_.length;){if(m<_[h]){h%2==0&&(n.push(u.substring(v+1,m)),v=m);break}h++}}v<u.length&&n.push(u.substring(v+1))}else""!=u&&(n=[u]);if(null!=n)for(h=0;h<n.length;h++)n[h]=n[h].replace(/^\s*"|"\s*$/gm,"").replace(/%escaped_double_quote%/gm,'"').replace(/%escaped_single_quote%/gm,"'");i&&"javascript"===i.toLowerCase()&&(o=d)}}}else{if(e.useContext){var y,b,$,w,S=null===(y=this._arena)||void 0===y||null===(b=y.instanceService)||void 0===b?void 0:b.getInstance("PublicAPI"),A=null==S?void 0:S.getPlayoutData().context;if(!A&&(null===($=e.contexts)||void 0===$?void 0:$.length)||A&&!(null===(w=e.contexts)||void 0===w?void 0:w.includes(A)))return}i=e.entity,o=e.command,n=e.parameters?e.parameters.map((function(e){return e.value})):[];for(h=0;h<n.length;h++)if("string"==typeof n[h])n[h]=this._replaceMacroStrings(n[h]);else if(n[h]&&n[h].datasource){var x=n[h].datasource;if(!a&&x&&"DatafeedValue"===x.sourceType&&x.sourceValue&&-1!==x.sourceValue.indexOf(":")){var T=x.sourceValue.split(":")[0];T&&!this._datafeeds[T]||this._datafeeds[T]==={}?(this._asyncDatasourceDispatches[T]||(this._asyncDatasourceDispatches[T]=[]),-1===this._asyncDatasourceDispatches[T].indexOf(e)&&this._asyncDatasourceDispatches[T].push(e),this._datafeeds[T]||this._fetchDatafeed(T),s=!0):n[h]=this._processDataSource(x)}else n[h]=this._processDataSource(x)}i.match(/javascript/i)&&(o=n[0])}if((a||!s)&&i)switch(i.toLowerCase()){case"navigation":t||this._handleAction_navigation(o,n);break;case"player":t||this._handleAction_player(o,n);break;case"javascript":this._handleAction_javascript(o);break;case"widget":this._handleAction_widget(o,n);break;case"group":this._handleAction_group(o,n);break;case"form":this._handleAction_form(o,n);break;case"download":this._handleAction_download(o,n);break;case"localstorage":this._handleAction_localstorage(o,n);break;case"message":this._handleAction_message(o,n);break;case"analytics":this._handleAction_analytics(o,n)}},TimelineWidget.prototype._handleAction_navigation=function(e,t){if("string"==typeof e&&void 0!==t&&t.length>0){var i,o,n=t[0],s=t[1]||"_self",a=null===(i=this._arena)||void 0===i||null===(o=i.instanceService)||void 0===o?void 0:o.getInstance("PublicAPI");a?a.doOpenUrl(n,s):("_blank"===s&&(s=this._generateRandomTarget()),window.open(n,s,"noopener"))}},TimelineWidget.prototype._handleAction_player=function(e,t){if("string"==typeof e){var i,o,n=null===(i=this._arena)||void 0===i||null===(o=i.instanceService)||void 0===o?void 0:o.getInstance("PublicAPI");if(!n)return;switch(e.toLowerCase()){case"play":n.play();break;case"pause":n.pause();break;case"mute":case"unmute":n.setMuted("mute"==e.toLowerCase(),!1,!0);break;case"programmute":case"programunmute":n.setProgramMuted("programmute"==e.toLowerCase());break;case"volume":void 0!==t&&t.length>0&&n.setVolume(parseFloat($2UpbQ.default.trim(t[0])));break;case"programvolume":void 0!==t&&t.length>0&&n.setProgramVolume(parseFloat($2UpbQ.default.trim(t[0])));break;case"seek":void 0!==t&&t.length>0&&n.seek(parseFloat($2UpbQ.default.trim(t[0])));break;case"seekchapter":if(void 0!==t&&t.length>0){var s=this._arena.getWidgetById($2UpbQ.default.trim(t[0]));null!=s&&null!=s._inpoint&&n.seek(parseFloat(s._inpoint))}break;case"load":void 0!==t&&t.length>0&&n.load({clipId:$2UpbQ.default.trim(t[0]),seekTo:parseFloat($2UpbQ.default.trim(t[1])),autoPlay:!0,shouldPlayInline:!0,initiator:"Widget/"+this._entityId,useSession:this._useSession});break;case"loadproject":void 0!==t&&t.length>0&&n.load({projectId:$2UpbQ.default.trim(t[0]),seekTo:parseFloat($2UpbQ.default.trim(t[1])),autoPlay:!0,shouldPlayInline:!0,initiator:"Widget/"+this._entityId,useSession:this._useSession});break;case"fullscreen":n.fullscreen();break;case"retractfullscreen":n.retractFullscreen();break;case"show":void 0!==t&&t.length>0&&n.showInterfaceElement(t[0]);break;case"hide":void 0!==t&&t.length>0&&n.hideInterfaceElement(t[0]);break;case"enable":void 0!==t&&t.length>0&&n.enableInterfaceElement(t[0]);break;case"disable":void 0!==t&&t.length>0&&n.disableInterfaceElement(t[0]);break;case"showsubtitlelayer":$2UpbQ.default(n.getSubtitleLayer()).show();break;case"hidesubtitlelayer":$2UpbQ.default(n.getSubtitleLayer()).hide();break;case"togglefullscreen":n.toggleFullscreen();break;case"skipad":"function"==typeof n.skipAd&&n.skipAd();break;case"setsubtitle":if(void 0!==t&&t.length>0)for(var a=n.getSubtitlesList()||[],l=0;l<a.length;l++){var r=a[l];if(void 0!==r.isocode&&null!=r.isocode&&void 0!==r.id&&null!=r.id&&r.isocode==$2UpbQ.default.trim(t[0])){n.setSubtitle(r.id);break}}break;case"setaudiotrack":if(void 0!==t&&t.length>0)for(a=n.getAudioTracks()||[],l=0;l<a.length;l++){if(void 0!==(u=a[l]).label&&null!=u.label&&void 0!==u.id&&null!=u.id&&u.label==$2UpbQ.default.trim(t[0])){n.selectAudioTrack(u.id);break}}break;case"setaudiotrackbyiso":if(void 0!==t&&t.length>0)for(a=n.getAudioTracks()||[],l=0;l<a.length;l++){var u;if(void 0!==(u=a[l]).isocode&&null!=u.label&&void 0!==u.id&&null!=u.id&&u.isocode==$2UpbQ.default.trim(t[0])){n.selectAudioTrack(u.id);break}}break;case"sharebyemail":this._handleSharing("email");break;case"shareonfacebook":this._handleSharing("facebook");break;case"shareontwitter":this._handleSharing("twitter");break;case"shareonlinkedin":this._handleSharing("linkedin");break;case"shareonpinterest":this._handleSharing("pinterest");break;case"shareonwhatsapp":this._handleSharing("whatsapp")}}},TimelineWidget.prototype._handleSharing=function(e){var t,i,o=null===(t=this._arena)||void 0===t||null===(i=t.instanceService)||void 0===i?void 0:i.getInstance("PublicAPI");o&&o.doShare(e)},TimelineWidget.prototype._handleAction_javascript=function(e,t){if("string"==typeof e){var i,o,n=this._arena.getDisallowScripts();if(this._executer||(this._executer=null===(i=this._arena)||void 0===i||null===(o=i.instanceService)||void 0===o?void 0:o.getInstance("Executer")),!n&&null!=this._executer&&"function"==typeof this._executer.execute){var s=null;return void 0!==t&&(s=t.join(",")),this._executer.execute(e+(null!=s?"("+s+")":""))}}},TimelineWidget.prototype._handleAction_widget=function(e,t){if($1MxPP.default("TimelineWidget: _handleAction_widget: "+e+" : "+t[0]),"string"==typeof e&&void 0!==t&&t.length>0){var i=this._arena.getWidgetById($2UpbQ.default.trim(t[0]));if(i)switch(e.toLowerCase()){case"setproperty":i._setProperty(t);break;case"callmethod":i._callMethod(t);break;default:var o=t.concat();o.splice(1,0,e),i._callMethod(o)}}},TimelineWidget.prototype._audioFadeOut=function(e,t){if("function"==typeof e.setVolume&&"function"==typeof e.getVolume){var i=e.getVolume();if(null!=i)var o=.05,n=setInterval((function(){i>o?(i-=o,e.setVolume(i)):(e.setVolume(0),clearInterval(n))}),1e3*t/(i/o))}},TimelineWidget.prototype._audioFadeIn=function(e,t,i){if("function"==typeof e.setVolume)var o=0,n=.05,s=setInterval((function(){o+n<i?(o+=n,e.setVolume(o)):(e.setVolume(i),clearInterval(s))}),1e3*t/(i/n))},TimelineWidget.prototype._handleAction_group=function(e,t){if("string"==typeof e&&void 0!==t&&t.length>0){var i=this._arena.getGroupById($2UpbQ.default.trim(t[0]));if(i)switch(e.toLowerCase()){case"setproperty":i.setProperty(t);break;case"callmethod":i.callMethod(t);break;default:var o=t.concat();o.splice(1,0,e),i.callMethod(o)}}},TimelineWidget.prototype._handleAction_form=function(e,t){if("string"==typeof e){var i="1";void 0!==t&&$dhZ6J.typeOf(t.length)>0&&(i=$2UpbQ.default.trim(t[0]));var o=this._arena.getWidgetById("form:"+i);null!=o&&void 0!==o.$element.data("TimelineWidgetForm")&&o.$element.data("TimelineWidgetForm").post()}},TimelineWidget.prototype._handleAction_localstorage=function(e,t){if("string"==typeof e&&void 0!==t&&t.length>0&&null!=t[0]&&void 0!==t[0])switch(e){case"setItem":if(this._localStorage&&null!=t[1]&&void 0!==t[1]){var i="string"==typeof t[1]&&t[1].substr(0,2);if("++"===i||"--"===i){var o=this._localStorage.get("bbtl_"+t[0]),n=o;null!=o&&void 0!==o||(o=0),"++"===i&&(n=parseFloat(o)+1),"--"===i&&(n=parseFloat(o)-1),this._localStorage.set("bbtl_"+t[0],n)}else this._localStorage.set("bbtl_"+t[0],t[1])}break;case"removeItem":this._localStorage&&this._localStorage.remove("bbtl_"+t[0]);break;case"setItemWithWidgetProperty":var s="",a=this._arena.getWidgetById($2UpbQ.default.trim(t[1]));null!=a&&"function"==typeof a.getValue&&(s=a.getValue()),this._localStorage&&this._localStorage.set("bbtl_"+t[0],s)}},TimelineWidget.prototype._handleAction_message=function(e,t){var i;"string"==typeof e&&""!=e&&($1MxPP.default("TimelineWidget: _handleAction_message: message = "+e),null===(i=this.$element)||void 0===i||i.trigger("bb_on_message",[{name:e,widgetId:this._entityId}]))},TimelineWidget.prototype._handleAction_analytics=function(e,t){if("string"==typeof e&&""!=e&&"logevent"==e&&($1MxPP.default("TimelineWidget: _handleAction_analytics: data = "+e),t.length>1&&""!=t[0]&&""!=t[1])){var i,o=t[0]+":"+t[1];null===(i=this.$element)||void 0===i||i.trigger("bb_widget_custom_analytics",[o])}},TimelineWidget.prototype._handleAction_download=function(e,t){if("string"==typeof e&&void 0!==t&&t.length>0&&null!=t[0]&&void 0!==t[0]){var i=t[0];this._documentDownload(i)}},TimelineWidget.prototype._documentDownload=function(e){var t,i,o="https://bb.bbvms.com/documentDownload.php?id="+e;this._arena&&(o=this._arena._server+"/documentDownload.php?id="+e);var n=navigator.userAgent.toLowerCase().indexOf("crios")>-1,s=navigator.userAgent.toLowerCase().indexOf("chrome")>-1,a=navigator.userAgent.toLowerCase().indexOf("safari")>-1;if(!n&&(s||a)){var l=document.createElement("a");if(l.href=o,void 0!==l.download){var r="download-"+e;l.download=r}if("function"==typeof MouseEvent){var u=new MouseEvent("click",{bubbles:!0,cancelable:!0});return l.dispatchEvent(u),!0}return window.bluebillywig._internal.Util.triggerEventOnJQueryObject($2UpbQ.default(l),"click"),!0}var d=null===(t=this._arena)||void 0===t||null===(i=t.instanceService)||void 0===i?void 0:i.getInstance("PublicAPI");d?d.doOpenUrl(o,"_blank"):window.open(o,"_blank","noopener")},TimelineWidget.prototype._performWidgetTransition=function(e){if(this.$element){this.$element.stop(),null!=this._savedStyles&&(this.$element.css(this._savedStyles),this._savedStyles=null),void 0!==this.$element.get(0).style?this._savedStyles={left:this.$element.get(0).style.left,top:this.$element.get(0).style.top,opacity:this.$element.css("opacity")}:this._savedStyles={left:this.$element.css("left"),top:this.$element.css("top"),opacity:this.$element.css("opacity")};var t=this.$element.parent().width(),i=this.$element.parent().height(),o=t>0?this.$element.width()/t*100:100,n=i>0?this.$element.height()/i*100:100,s=isNaN(parseFloat(e[1]))?800:1e3*parseFloat(e[1]),a={};switch(e[2]){case"Slide in from left":a.left=this._savedStyles.left,this.$element.css("left",this._savedStyles.left.indexOf("%")<0?"-"+this.$element.width()+"px":"-"+o+"%");break;case"Slide in from right":a.left=this._savedStyles.left,this.$element.css("left",this._savedStyles.left.indexOf("%")<0?t+"px":"100%");break;case"Slide in from top":a.top=this._savedStyles.top,this.$element.css("top",this._savedStyles.top.indexOf("%")<0?"-"+this.$element.height()+"px":"-"+n+"%");break;case"Slide in from bottom":a.top=this._savedStyles.top,this.$element.css("top",this._savedStyles.top.indexOf("%")<0?i+"px":"100%");break;case"Slide out to left":a.left=this._savedStyles.left.indexOf("%")<0?"-"+t+"px":"-100%";break;case"Slide out to right":a.left=this._savedStyles.left.indexOf("%")<0?t+"px":"100%";break;case"Slide out to top":a.top=this._savedStyles.top.indexOf("%")<0?"-"+i+"px":"-100%";break;case"Slide out to bottom":a.top=this._savedStyles.top.indexOf("%")<0?i+"px":"100%"}switch(e[3]){case"fade in":this.$element.css("opacity","0.0"),a.opacity="1.0";break;case"fade out":a.opacity="0.0"}var l="linear";switch(e[4]){case"lineair":l="linear";break;case"easeInExpo":case"easeOutExpo":case"easeInBounce":case"easeOutBounce":l="swing"}this.$element.data("styles",a),-1==e[2].indexOf("out")&&-1==e[3].indexOf("out")?("image"==this._type&&this.$element.css("visibility","visible"),this.show(),this.$element.animate(a,s,l,$2UpbQ.default.proxy(TimelineWidget.prototype._handleWidgetTransitionInDone,this))):this.$element.animate(a,s,l,$2UpbQ.default.proxy(TimelineWidget.prototype._handleWidgetTransitionOutDone,this))}},TimelineWidget.prototype._performWidgetCustomTransition=function(e){if(this.$element){this.$element.stop();var t=isNaN(parseFloat(e[1]))?800:1e3*parseFloat(e[1]),i={};switch(i.left=e[2],i.top=e[3],i.width=e[4],i.height=e[5],e[6]){case"fade in":this.$element.css("opacity","0.0"),i.opacity="1.0";break;case"fade out":i.opacity="0.0"}var o="linear";switch(e[7]){case"lineair":o="linear";break;case"easeInExpo":case"easeOutExpo":case"easeInBounce":case"easeOutBounce":o="swing"}this.$element.data("styles",i),-1==e[6].indexOf("out")?("image"==this._type&&this.$element.css("visibility","visible"),this.show(),this.$element.animate(i,t,o,$2UpbQ.default.proxy(TimelineWidget.prototype._handleWidgetTransitionInDone,this))):this.$element.animate(i,t,o,$2UpbQ.default.proxy(TimelineWidget.prototype._handleWidgetTransitionOutDone,this))}},TimelineWidget.prototype._handleWidgetTransitionInDone=function(){if(null!=this._savedStyles&&this.$element.css(this._savedStyles),this._savedStyles=null,"array"===$dhZ6J.typeOf(this._ontransitionDoneActions)||"object"==typeof this._ontransitionDoneActions)for(var e in this._ontransitionDoneActions)parseInt(e)>=0&&this._handleAction(this._ontransitionDoneActions[e])},TimelineWidget.prototype._handleWidgetTransitionOutDone=function(){if(this.hide(),null!=this._savedStyles&&this.$element.css(this._savedStyles),"array"===$dhZ6J.typeOf(this._ontransitionDoneActions)||"object"==typeof this._ontransitionDoneActions)for(var e in this._ontransitionDoneActions)parseInt(e)>=0&&this._handleAction(this._ontransitionDoneActions[e])},TimelineWidget.prototype._setProperty=function(e){if(void 0!==e[1]&&null!=e[1]&&void 0!==e[2]&&null!=e[2]){var t={};e[1].indexOf("/")>-1?TimelineWidget._expandComplexKey(e[1],e[2],null,t):t[e[1]]=e[2],this.update(t)}},TimelineWidget._expandComplexKey=function(e,t,i,o){var n=e.split("/");i&&"object"==typeof i[n[0]]&&(o[n[0]]=JSON.parse(JSON.stringify(i[n[0]])));for(var s=o,a=0,l=n.length;a<l-1;a++)"object"!=typeof s[n[a]]&&(s[n[a]]={}),s=s[n[a]];if(s[n[n.length-1]]=t,"font"===n[n.length-1]&&t){var r=t.indexOf(";");r>-1&&(s.embeddedfont=t.substring(0,r),s.font=t.substring(r+1))}},TimelineWidget.prototype._callMethod=function(e){if(void 0!==e[1]&&null!==e[1]){var t=e[1],i=[].concat(e);if(t.indexOf(":")>-1){var o=t.split(":");i[1]=t=o[0],i.splice(2,0,o[1])}if(i.splice(0,1),"string"==typeof t&&void 0!==i&&i.length>0)switch(t.toLowerCase()){case"setproperty":this._setProperty(i);break;case"show":this.show();break;case"hide":this.hide();break;case"restoreinitialconfig":this.restoreInitialConfig();break;case"toggleimage":"function"==typeof this.toggleContent&&this.toggleContent();break;case"transition":i.length>1&&this._performWidgetTransition(i);break;case"customtransition":i.length>1&&this._performWidgetCustomTransition(i);break;case"pause":"function"==typeof this.pause&&this.pause();break;case"resume":case"play":"function"==typeof this.resume&&this.resume();break;case"seek":"function"==typeof this.seek&&i.length>1&&""!=i[1]&&this.seek(Number(i[1]));break;case"mute":"function"==typeof this.mute&&this.mute();break;case"unmute":"function"==typeof this.unmute&&this.unmute();break;case"setvolume":"function"==typeof this.setVolume&&i.length>1&&""!=i[1]&&this.setVolume(Number(i[1])/100);break;case"volumetransition":i.length>2&&""!=i[1]&&""!=i[2]&&("fade out"==i[2]?this._audioFadeOut(this,i[1]):"fade in"==i[2]&&""!=i[3]&&this._audioFadeIn(this,i[1],i[3]/100));break;case"setvalue":i.length>1&&null!=i[1]&&("function"==typeof this.setValue?this.setValue(i[1]):""!=i[1]&&this.update({value:i[1]}));break;case"start":"function"==typeof this.start&&this.start();break;case"stop":"function"==typeof this.stop&&this.stop();break;case"reset":"function"==typeof this.reset&&this.reset()}}},TimelineWidget.prototype._generateRandomTarget=function(){var e=new Date;return(Math.random().toString()+"_"+e.getTime()).replace(/[-.\s]/g,"")},TimelineWidget.prototype._evaluateConditions=function(e){var t={},i=[],o="";for(var n in e)if("expression"!=n){i.push(n);var s=/^(\w*):(.*)$/.exec($2UpbQ.default.trim(e[n]));if(s&&s.length>2){var a=s[1].toString();s[2]=this._replaceMacroStrings(s[2]);var l=s[2].match(/dataSource:\{[^}]*\}/gm);if(null!=l)for(var r=0;r<l.length;r++)s[2]=s[2].replace(l[r],this._processDataSource(l[r]));switch(a.toLowerCase()){case"widget":t[n]=this._evaluateCondition_widget(s[2]);break;case"player":t[n]=this._evaluateCondition_player(s[2]);break;case"localstorage":t[n]=this._evaluateCondition_localstorage(s[2]);break;case"compare":t[n]=this._evaluateCondition_compare(s[2])}}else t[n]=!1}else o=e[n];return""==o&&(o=i.join(" AND ")),this._evaluateExpression(o,t)},TimelineWidget.prototype._evaluateCondition=function(e){var t=!0;if(e&&e.variables&&e.variables.length>0){for(var i={},o=[],n=e.expression,s=0;s<e.variables.length;s++){var a=e.variables[s],l=a.name;if(o.push(l),a.rule){var r=$2UpbQ.default.extend({},a.rule);if(r.lvalue)if("string"==typeof r.lvalue)r.lvalue=this._replaceMacroStrings(r.lvalue);else{var u=r.lvalue.datasource?r.lvalue.datasource:r.lvalue;r.lvalue=this._processDataSource(u)}if(r.rvalue)if("string"==typeof r.rvalue)r.rvalue=this._replaceMacroStrings(r.rvalue);else{var d=r.rvalue.datasource?r.rvalue.datasource:r.rvalue;r.rvalue=this._processDataSource(d)}switch(a.entityType){case"widget":i[l]=this._evaluateRule_widget(r,a.entityId);break;case"player":i[l]=this._evaluateRule_player(r,a.entityId);break;case"localstorage":i[l]=this._evaluateRule_localstorage(r);break;case"compare":i[l]=this._evaluateRule_compare(r)}}}n||(n=o.join(" AND ")),t=this._evaluateExpression(n,i)}return t},TimelineWidget.prototype._evaluateRule_widget=function(e,t){var i=!1;if(e){var o=this._arena.getWidgetById(t);e.lvalue=null!=o?o.getPropertyValue(e.lvalue):"visible"==e.lvalue||"toggled"==e.lvalue||"playing"==e.lvalue||"valid"==e.lvalue?"false":null,i=this._evaluateRule(e)}return i},TimelineWidget.prototype._evaluateRule_player=function(e,t){var i=!1;if(e){var o,n,s=null;(s=t?window.bluebillywig.getPlayerInstance(t):null===(o=this._arena)||void 0===o||null===(n=o.instanceService)||void 0===n?void 0:n.getInstance("PublicAPI"))&&(e.lvalue=s.getPropertyValue(e.lvalue),i=this._evaluateRule(e))}return i},TimelineWidget.prototype._evaluateRule_localstorage=function(e){var t=!1;return e&&(e.lvalue=this._localStorage?this._localStorage.get("bbtl_"+e.lvalue):null,t=this._evaluateRule(e)),t},TimelineWidget.prototype._evaluateRule_compare=function(e){var t=!1;return e&&(t=this._evaluateRule(e)),t},TimelineWidget.prototype._evaluateCondition_widget=function(e){var t=!1,i=/(.*)\((.*)\)/.exec(e);if(null!=i){var o=$2UpbQ.default.trim(i[1]),n=String(i[2]).split(",");n[1]=String(n[1]).replace(":","==");var s=$2UpbQ.default.trim(n[1]).match(/(.*[^><!=~])(==|!=|~=|<|<=|>|>=)([^><!=~].*)/);if(null!=s&&s.length>3){var a={lvalue:s[1],operator:s[2],rvalue:s[3]};o.toLowerCase();var l=this._arena.getWidgetById(n[0].toLowerCase());a.lvalue=null!=l?l.getPropertyValue(a.lvalue):"visible"==a.lvalue||"toggled"==a.lvalue||"playing"==a.lvalue||"valid"==a.lvalue?"false":null,t=this._evaluateRule(a)}}return t},TimelineWidget.prototype._evaluateCondition_player=function(e){var t,i,o=!1,n=null===(t=this._arena)||void 0===t||null===(i=t.instanceService)||void 0===i?void 0:i.getInstance("PublicAPI"),s=/(.*)\((.*)\)/.exec(e);if(null!=s){var a=$2UpbQ.default.trim(s[1]),l=String(s[2]).split(",");l[1]=String(l[1]).replace(":","==");var r=$2UpbQ.default.trim(l[1]).match(/(.*[^><!=~])(==|!=|~=|<|<=|>|>=)([^><!=~].*)/);if(null!=r&&r.length>3){var u={lvalue:r[1],operator:r[2],rvalue:r[3]};a.toLowerCase(),u.lvalue=null==n?void 0:n.getPropertyValue(u.lvalue),o=this._evaluateRule(u)}}return o},TimelineWidget.prototype._evaluateCondition_localstorage=function(e){var t=!1,i=/(.*)\((.*)\)/.exec(e);if(null!=i){var o=$2UpbQ.default.trim(i[1]),n=String(i[2]).split(",");n[1]=String(n[1]).replace(":","==");var s=$2UpbQ.default.trim(n[1]).match(/(.*[^><!=~])(==|!=|~=|<|<=|>|>=)([^><!=~].*)/);if(null!=s&&s.length>3){var a={lvalue:s[1],operator:s[2],rvalue:s[3]};o.toLowerCase(),a.lvalue=this._localStorage?this._localStorage.get("bbtl_"+a.lvalue):null,t=this._evaluateRule(a)}}return t},TimelineWidget.prototype._evaluateCondition_compare=function(e){var t=!1,i=/(.*)\((.*)\)/.exec(e);if(null!=i){var o=$2UpbQ.default.trim(i[1]),n=String(i[2]).split(",");n[1]=String(n[1]).replace(":","==");var s=$2UpbQ.default.trim(n[1]).match(/(.*[^><!=~])(==|!=|~=|<|<=|>|>=)([^><!=~].*)/);if(null!=s&&s.length>3){var a={lvalue:s[1],operator:s[2],rvalue:s[3]};o.toLowerCase(),t=this._evaluateRule(a)}}return t},TimelineWidget.prototype._evaluateRule=function(e){if(null!=e)switch(e.operator){default:case"==":return String(e.lvalue)==String(e.rvalue);case"!=":return String(e.lvalue)!=String(e.rvalue);case"contains":return String(e.lvalue).toLowerCase().indexOf(String(e.rvalue).toLowerCase())>=0;case"doesNotContain":return String(e.lvalue).toLowerCase().indexOf(String(e.rvalue).toLowerCase())<0;case">=":return parseFloat(e.lvalue)>=parseFloat(e.rvalue);case">":return parseFloat(e.lvalue)>parseFloat(e.rvalue);case"<=":return parseFloat(e.lvalue)<=parseFloat(e.rvalue);case"<":return parseFloat(e.lvalue)<parseFloat(e.rvalue)}return!1},TimelineWidget.prototype.getPropertyValue=function(e){if(void 0===e||null==e)return!1;if(null==e?void 0:e.startsWith("stats_"))return this._getStatsMetric(e.substring(6));var t=null,i=e.toString().split(".");if(null!=i&&i.length>0)switch(i[0]){case"valid":"function"==typeof this.isValid&&(t=this.isValid());break;case"value":"function"==typeof this.getValue&&(t=this.getValue());break;case"running":"function"==typeof this.isRunning&&(t=this.isRunning());break;case"visible":void 0!==this._isCurrentlyShown&&(t=this._isCurrentlyShown);break;case"toggled":"function"==typeof this.isToggled&&(t=this.isToggled());break;case"playing":"function"==typeof this.isPlaying&&(t=this.isPlaying());break;default:i.length>1&&"function"==typeof this.getPropertyValue&&(t=this.getPropertyValue(e))}return t},TimelineWidget.prototype._getStatsMetric=function(e){var t,i,o=null===(t=this._sharedDataService)||void 0===t||null===(i=t.getWidgetStats)||void 0===i?void 0:i.call(t,this._entityId);return(null==o?void 0:o[e])||0},TimelineWidget.prototype._evaluateExpression=function(expression,variables){var ret=!1;for(var key in expression=expression.replace(/AND/g,"&&").replace(/OR/g,"||"),variables){var keyRe=new RegExp(key,"g"),value="true"===variables[key]||!0===variables[key]||1===variables[key];expression=expression.replace(keyRe,value.toString())}var match_open=expression.match(/\(/g),count_open=null!=match_open?match_open.length:0,match_closed=expression.match(/\)/g),count_closed=null!=match_open?match_closed.length:0,match_exclusive=expression.replace(/&&/g,"").replace(/\|\|/g,"").replace(/true/g,"").replace(/false/g,"").match(/^[()\s]*$/);if(null!=match_exclusive&&match_exclusive.length>0&&count_closed==count_open)try{ret=eval(expression)}catch(e){"undefined"!=typeof console&&console.log("Notice: there was an error executing the javascript by evaluateExpression. Expression was: "+expression)}return ret},TimelineWidget.prototype._replaceMacroStrings=function(e){var t,i,o=null===(t=this._arena)||void 0===t||null===(i=t.instanceService)||void 0===i?void 0:i.getInstance("PublicAPI"),n=e?String(e).match(/{{\s*[\w\.]+\s*}}/g):null;if(null!=n)for(var s=n.map((function(e){return e.match(/[\w\.]+/)[0]})),a=0;a<s.length;a++){var l=s[a].split(".");if(l.length>1){switch(l[0]){case"mediaclip":if(void 0!==o&&null!=o){var r=o.getClipData();null!=r&&(d=r[l[1]])}break;case"asset":var u=o.getCurrentAsset();null!=u&&(d=u[l[1]]);break;case"player":var d=o.getPropertyValue(l[1]);break;case"playout":d=o.getPlayoutData()[l[1]];break;case"localstorage":if(this._localStorage){var c=this._localStorage.get("bbtl_"+l[1]);void 0!==c&&null!=c?("string"==typeof c&&(c=c.replace(",","&comma;")),d=c):d=""}else d="";break;case"querystring":var h;if(null===(h=this._opts)||void 0===h?void 0:h.joinedRequestParams){var p=this._opts.joinedRequestParams[String(l[1])];if(null!=p&&void 0!==p&&""!=p){var f;try{f=$2UpbQ.default.base64.decode(p)}catch(e){}d=null!=f&&void 0!==f?f:p}else d=""}}void 0!==d&&null!=d||(d=""),e=e.replace("{{"+s[a]+"}}",d)}}return e},TimelineWidget.prototype._onResized=function(e){null!=this.lastConfigForTranslation&&this.update(this.lastConfigForTranslation)},TimelineWidget.prototype.getAbsoluteValueFromWidth=function(e){if(e.indexOf("%")>=0&&void 0!==this.$element.parent&&void 0!==this.$element.parent().width)return this.$element.parent().width()/100*e.substring(0,e.indexOf("%"))},TimelineWidget.prototype.getAbsoluteValueFromHeight=function(e){if(e.indexOf("%")>=0&&void 0!==this.$element.parent&&void 0!==this.$element.parent().height)return this.$element.parent().height()/100*e.substring(0,e.indexOf("%"))},TimelineWidget.prototype.getLinesIntersectionPoint=function(e,t,i,o,n,s,a,l){var r,u,d,c,h={x:null,y:null};return 0==(r=(l-s)*(i-e)-(a-n)*(o-t))||(c=(i-e)*(u=t-s)-(o-t)*(d=e-n),u=((a-n)*u-(l-s)*d)/r,d=c/r,h.x=e+u*(i-e),h.y=t+u*(o-t)),h}})),parcelRequire.register("39gdZ",(function(e,t){$parcel$export(e.exports,"default",(function(){return u}));var i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[]];return{rows:e.length,columns:e.reduce((function(e,t){return Math.max(e,t.length)}),0)}},o=function(e){var t=i(e);return t.rows===t.columns},n=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,i=[],o=0;o<e;o++){i[o]=[];for(var n=0;n<t;n++)i[o][n]=0}return i},s=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=n(e,t),s=Math.min(e,t),a=0;a<s;a++)o[a][a]=i;return o},a=function(e){for(var t=[],i=0;i<e.length;i++)t[i]=Array.isArray(e[i])?a(e[i]):e[i];return t},l=function(e){for(var t=a(e),o=i(t),n=o.rows,s=o.columns,l=[],u=0;u<n;u++)l[u]=u;for(var d=1,c=[],h=0;h<s;h++){for(var p=0;p<n;p++)c[p]=t[p][h];for(var f=0;f<n;f++){for(var g=Math.min(f,h),_=0,v=0;v<g;v++)_+=t[f][v]*c[v];c[f]-=_,t[f][h]=c[f]}for(var m=h,y=h+1;y<n;y++)Math.abs(c[y])>Math.abs(c[m])&&(m=y);if(m!==h){for(var b=0;b<s;b++){var $=t[m][b];t[m][b]=t[h][b],t[h][b]=$}var w=l[m];l[m]=l[h],l[h]=w,d=-d}if(h<n&&0!==t[h][h])for(var S=h+1;S<n;S++)t[S][h]=t[S][h]/t[h][h]}return{lu:t,pivotVector:l,pivotSign:d,solve:function(e){var o=i(e),a=o.rows,u=o.columns;if(n!==a)throw new Error("Invalid matrix dimensions");if(function(){for(var e=0;e<s;e++)if(0===t[e][e])return!0;return!1}())throw new Error("LU matrix is singular");for(var d=r(e,l,0,u-1),c=0;c<s;c++)for(var h=c+1;h<s;h++)for(var p=0;p<u;p++)d[h][p]=d[h][p]-d[c][p]*t[h][c];for(var f=s-1;f>=0;f--){for(var g=0;g<u;g++)d[f][g]=d[f][g]/t[f][f];for(var _=0;_<f;_++)for(var v=0;v<u;v++)d[_][v]=d[_][v]-d[f][v]*t[_][f]}return d}}},r=function(e,t){for(var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:i(e).columns-1,s=i(e).rows,a=[],l=0;l<t.length;l++){a[l]=[];for(var r=o;r<=n;r++){if(t[l]<0||t[l]>=s)throw new RangeError("Row index out of range: ".concat(t[l]));a[l][r-o]=e[t[l]][r]}}return a},u={inspect:i,isSquare:o,zeros:n,identity:s,clone:a,luDecomposition:l,inverse:function(e){return function(e,t){if(!o(e))throw new Error("Matrix is not square");return l(e).solve(t)}(e,s(i(e).rows))},multiplyVector:function(e,t){for(var o=i(e),n=[],s=0;s<o.rows;s++)for(var a=0;a<o.columns;a++)n[s]=n[s]||[],n[s][a]=e[s][a]*(t[s]||0);return n},subMatrixRow:r,getColumn:function(e,t){for(var o=i(e),n=[],s=0;s<o.rows;s++)n[s]=e[s][t]||0;return n}}}))})();